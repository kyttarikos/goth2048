<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>2048 — for Denise</title>

<style>
/* Fonts */
@font-face {
  font-display: swap;
  font-family: 'UnifrakturMaguntia';
  font-style: normal;
  font-weight: 400;
  src: url('../fonts/unifrakturmaguntia-v21-latin-regular.woff2') format('woff2');
}

:root {
  --bg:#0b0606;
  --panel:#1a0d0d;
  --accent:#c41b2f;
  --muted: rgba(255,255,255,0.08);
  --tile-text:#fff;
  --glass: rgba(255,255,255,0.03);
}

* { box-sizing:border-box; }
html,body { height:100%; margin:0; padding:0; }

body {
  font-family: "Times New Roman", Times, serif;
  background: radial-gradient(circle at 10% 10%, rgba(196,27,47,0.06) 0%, transparent 20%), var(--bg);
  color:var(--tile-text);
  display:flex;
  align-items:center;
  justify-content:center;
  padding:24px;
  overflow:hidden;
  -webkit-font-smoothing:antialiased;
}

.bg-text-wrap {
  position:fixed;
  inset:0;
  pointer-events:none;
  z-index:0;
}

.bg-text {
  position:absolute;
  white-space:pre-wrap;
  line-height:1.25;
  color:var(--accent);
  opacity:0.12;
  mix-blend-mode:screen;
  font-size:20px;
  filter: blur(0.2px);
}

.bg-text.center {
  top:-20%;
  left:50%;
  transform:translateX(-50%);
  width:100%;
  max-width:900px;
  text-align:center;
  animation: slideDownUp 30s linear infinite alternate;
}
.bg-text.center.alt {
  top:60%;
  animation-duration:36s;
  animation-direction:alternate-reverse;
  opacity:0.08;
  transform:translateX(-50%) scale(1.05);
}
.bg-text.side {
  top:0;
  height:100%;
  writing-mode: vertical-rl;
  font-size:16px;
  opacity:0.08;
}
.bg-text.side.left {
  left:0;
  animation: slideUp 40s linear infinite alternate;
}
.bg-text.side.right {
  right:0;
  animation: slideDown 40s linear infinite alternate;
}

@keyframes slideDownUp {
  from { transform:translateX(-50%) translateY(-10%); }
  to   { transform:translateX(-50%) translateY(120%); }
}
@keyframes slideUp {
  from { transform: translateY(100%) rotate(180deg); }
  to   { transform: translateY(-100%) rotate(180deg); }
}
@keyframes slideDown {
  from { transform: translateY(-100%) rotate(180deg); }
  to   { transform: translateY(100%) rotate(180deg); }
}

.container {
  width:420px;
  max-width:92vw;
  z-index:2;
  position:relative;
}

header {
  display:flex;
  align-items:center;
  justify-content:space-between;
  margin-bottom:14px;
}

.title {
  font-family: 'UnifrakturMaguntia', cursive;
  font-size:28px;
  color:var(--accent);
}
.subtitle { font-size:12px; color:var(--muted); }

.scoreboard {
  display:flex;
  gap:10px;
  align-items:center;
}
.score {
  background:linear-gradient(180deg, rgba(255,255,255,0.03), rgba(255,255,255,0.02));
  padding:8px 12px;
  border-radius:8px;
  text-align:center;
  min-width:72px;
}
.score .num { font-weight:700; font-size:16px; }

.controls { display:flex; gap:8px; margin-top:8px; }
.btn {
  background:transparent;
  border:1px solid rgba(255,255,255,0.06);
  padding:6px 10px;
  border-radius:8px;
  color:var(--tile-text);
  cursor:pointer;
  font-size:13px;
}
.btn:hover { border-color:var(--accent); }

.board-wrap {
  background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
  padding:18px;
  border-radius:12px;
  box-shadow: 0 8px 30px rgba(0,0,0,0.6);
  position:relative;
}

.grid {
  width:384px;
  max-width:86vw;
  height:384px;
  background:var(--panel);
  border-radius:8px;
  padding:12px;
  display:grid;
  grid-template-columns:repeat(4,1fr);
  grid-template-rows:repeat(4,1fr);
  gap:12px;
  position:relative;
}

.cell {
  background:var(--glass);
  border-radius:6px;
}

.tiles {
  position:absolute;
  top:12px; left:12px; right:12px; bottom:12px;
  border-radius:8px;
  pointer-events:none;
}

.tile {
  position:absolute;
  display:flex;
  align-items:center;
  justify-content:center;
  border-radius:6px;
  font-weight:800;
  font-size:22px;
  box-shadow:0 6px 18px rgba(0,0,0,0.6);
  color:var(--tile-text);
  transition: transform 150ms ease-in-out;
}
.tile.large { font-size:18px; padding:6px; }

.tile.v2{background:#2b0909}
.tile.v4{background:#3b0c0c}
.tile.v8{background:#c41b2f}
.tile.v16{background:#9b1018}
.tile.v32{background:#e03b4e}
.tile.v64{background:#ff6b6b}
.tile.v128{background:#f2a6aa;color:#111}
.tile.v256{background:#f6c5c8;color:#111}
.tile.v512{background:#ffebee;color:#111}

.tile.merged { animation: pop 200ms ease; }
@keyframes pop { from{transform:scale(1.1);} to{transform:scale(1);} }

.overlay {
  position:absolute;
  inset:0;
  display:flex;
  align-items:center;
  justify-content:center;
  z-index:4;
  pointer-events:none;
}
.message {
  background:rgba(0,0,0,0.6);
  backdrop-filter:blur(4px);
  padding:18px 22px;
  border-radius:10px;
  text-align:center;
  color:#fff;
  pointer-events:auto;
}

footer { margin-top:12px; color:var(--muted); font-size:12px; text-align:center; }

@media (max-width:420px) {
  .grid { width:calc(92vw); height:calc(92vw); }
}
</style>
</head>
<body>

<div class="bg-text-wrap">
  <div class="bg-text center">[LYRICS HERE]</div>
  <div class="bg-text center alt">[LYRICS HERE]</div>
  <div class="bg-text side left">[LYRICS HERE]</div>
  <div class="bg-text side right">[LYRICS HERE]</div>
</div>

<main class="container">
  <header>
    <div>
      <div class="title">2048</div>
      <div class="subtitle">red & black — for denise</div>
    </div>
    <div class="scoreboard">
      <div class="score"><div style="font-size:11px;opacity:0.7">SCORE</div><div class="num" id="score">0</div></div>
      <div class="score"><div style="font-size:11px;opacity:0.7">BEST</div><div class="num" id="best">0</div></div>
    </div>
  </header>

  <div class="board-wrap">
    <div class="grid" id="grid">
      <!-- 16 base cells -->
      ${'<div class="cell"></div>'.repeat(16)}
    </div>
    <div class="tiles" id="tiles"></div>
    <div class="overlay" id="overlay" style="display:none">
      <div class="message">
        <div id="messageText"></div>
        <div style="margin-top:8px"><button class="btn" id="tryAgain">Try again</button></div>
      </div>
    </div>
  </div>

  <div class="controls">
    <button class="btn" id="newGame">New Game</button>
    <button class="btn" id="undoBtn">Undo</button>
    <div style="flex:1"></div>
    <div style="font-size:12px;color:var(--muted);align-self:center">for denise. ily &lt;3 - i.m.</div>
  </div>

  <footer>Controls: Arrow keys / WASD / Swipe. Goal: make 2048 tile.</footer>
</main>

<script>
// --- 2048 with sliding animations ---
(function(){
  const size = 4;
  let board = createEmpty();
  let tiles = [];
  let score = 0;
  let best = Number(localStorage.getItem('denise_2048_best')||0);
  let previous = null;
  const tilesLayer = document.getElementById('tiles');
  const scoreEl = document.getElementById('score');
  const bestEl = document.getElementById('best');
  const overlay = document.getElementById('overlay');
  const messageText = document.getElementById('messageText');
  bestEl.textContent = best;

  function createEmpty(){ return Array.from({length:size},()=>Array(size).fill(null)); }

  function resetGame(){
    previous = null;
    board = createEmpty();
    tiles = [];
    score = 0; updateScore();
    overlay.style.display='none';
    addRandom(); addRandom();
    render();
  }

  function addRandom(){
    const empties=[];
    for(let r=0;r<size;r++)for(let c=0;c<size;c++)if(!board[r][c])empties.push([r,c]);
    if(!empties.length) return false;
    const [r,c]=empties[Math.floor(Math.random()*empties.length)];
    const id = Date.now()+Math.random();
    const value = Math.random()<0.9?2:4;
    const tile = {id,value,row:r,col:c,merged:false};
    board[r][c] = tile;
    tiles.push(tile);
    return true;
  }

  function updateScore(){
    scoreEl.textContent=score;
    if(score>best){ best=score; bestEl.textContent=best; localStorage.setItem('denise_2048_best', best); }
  }

  function render(){
    tilesLayer.innerHTML='';
    const cellSize = getCellSize();
    tiles.forEach(tile=>{
      const el=document.createElement('div');
      el.className='tile v'+tile.value+(tile.value>=128?' large':'');
      el.textContent=tile.value;
      const left=tile.col*(cellSize+12);
      const top=tile.row*(cellSize+12);
      el.style.transform=`translate(${left}px,${top}px)`;
      el.style.width=cellSize+'px';
      el.style.height=cellSize+'px';
      tilesLayer.appendChild(el);
    });
  }

  function getCellSize(){
    const cell=document.querySelector('.cell');
    return cell ? cell.getBoundingClientRect().width : 84;
  }

  function move(dir){
    previous={board: board.map(row=>row.map(cell=>cell?{...cell}:null)), tiles: tiles.map(t=>({...t})), score};
    let moved=false;
    const vector = {left:[0,-1], right:[0,1], up:[-1,0], down:[1,0]}[dir];
    const traverseRows = vector[0]===1 ? [...Array(size).keys()].reverse() : [...Array(size).keys()];
    const traverseCols = vector[1]===1 ? [...Array(size).keys()].reverse() : [...Array(size).keys()];
    tiles.forEach(t=>t.merged=false);
    for(const r of traverseRows){
      for(const c of traverseCols){
        const tile=board[r][c];
        if(!tile) continue;
        let nr=r, nc=c;
        while(true){
          const rr=nr+vector[0], cc=nc+vector[1];
          if(rr<0||rr>=size||cc<0||cc>=size) break;
          if(!board[rr][cc]){
            nr=rr; nc=cc;
          } else if(board[rr][cc].value===tile.value && !board[rr][cc].merged && !tile.merged){
            board[rr][cc].value*=2;
            score+=board[rr][cc].value;
            board[rr][cc].merged=true;
            board[nr][nc]=null;
            tiles=tiles.filter(t=>t!==tile);
            moved=true;
            break;
          } else break;
        }
        if(nr!==r || nc!==c){
          board[nr][nc]=tile;
          board[r][c]=null;
          tile.row=nr; tile.col=nc;
          moved=true;
        }
      }
    }
    if(moved){ addRandom(); updateScore(); render(); checkEnd(); }
  }

  function hasMoves(){
    for(let r=0;r<size;r++)for(let c=0;c<size;c++){
      if(!board[r][c]) return true;
      if(c<size-1 && board[r][c].value===board[r][c+1]?.value) return true;
      if(r<size-1 && board[r][c].value===board[r+1][c]?.value) return true;
    }
    return false;
  }

  function checkEnd(){
    if(tiles.some(t=>t.value===2048)){ showMessage('You win!'); return; }
    if(!hasMoves()){ showMessage('Game over'); }
  }

  function showMessage(msg){
    messageText.textContent=msg;
    overlay.style.display='flex';
  }

  window.addEventListener('keydown',e=>{
    const k=e.key;
    if(['ArrowLeft','a','A'].includes(k)) move('left');
    if(['ArrowRight','d','D'].includes(k)) move('right');
    if(['ArrowUp','w','W'].includes(k)) move('up');
    if(['ArrowDown','s','S'].includes(k)) move('down');
  });

  let sx=null, sy=null;
  window.addEventListener('touchstart',e=>{
    sx=e.touches[0].clientX; sy=e.touches[0].clientY;
  },{passive:true});
  window.addEventListener('touchend',e=>{
    if(sx===null) return;
    const dx=e.changedTouches[0].clientX - sx;
    const dy=e.changedTouches[0].clientY - sy;
    if(Math.abs(dx)>30 || Math.abs(dy)>30){
      if(Math.abs(dx)>Math.abs(dy)) move(dx>0?'right':'left');
      else move(dy>0?'down':'up');
    }
    sx=sy=null;
  },{passive:true});

  document.getElementById('newGame').addEventListener('click', resetGame);
  document.getElementById('tryAgain').addEventListener('click', resetGame);
  document.getElementById('undoBtn').addEventListener('click',()=>{
    if(previous){
      board = previous.board.map(row=>row.map(cell=>cell?{...cell}:null));
      tiles = previous.tiles.map(t=>({...t}));
      score=previous.score;
      updateScore();
      render();
      overlay.style.display='none';
      previous=null;
    }
  });

  resetGame();
})();
</script>
</body>
</html>

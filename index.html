<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Goth 2048</title>
<style>
    body {
        margin: 0;
        font-family: 'Courier New', monospace;
        background-color: #0a0a0a;
        color: #f0f0f0;
        overflow: hidden;
    }
    .background {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-image: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32"><text y="20" font-size="24">ðŸ¥€</text></svg>');
        background-size: 40px 40px;
        animation: moveBg 10s linear infinite;
        z-index: -1;
    }
    @keyframes moveBg {
        0% { background-position: 0 0; }
        100% { background-position: 40px 40px; }
    }
    .game-container {
        width: 400px;
        margin: 50px auto;
        background: #1a1a1a;
        padding: 10px;
        border-radius: 10px;
        box-shadow: 0 0 20px rgba(255,0,128,0.5);
    }
    .grid {
        display: grid;
        grid-template-columns: repeat(4, 1fr);
        gap: 10px;
    }
    .tile {
        width: 90px;
        height: 90px;
        background: #2a2a2a;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 24px;
        font-weight: bold;
        border-radius: 5px;
        color: #f0f0f0;
        transition: transform 0.2s ease, background-color 0.3s ease;
    }
    .tile.new {
        animation: pop 0.3s ease;
    }
    @keyframes pop {
        0% { transform: scale(0.5); }
        100% { transform: scale(1); }
    }
</style>
</head>
<body>
<div class="background"></div>
<div class="game-container">
    <div class="grid" id="grid"></div>
</div>
<script>
    const gridSize = 4;
    let grid = [];

    function initGrid() {
        grid = Array(gridSize).fill().map(() => Array(gridSize).fill(0));
        addRandomTile();
        addRandomTile();
        renderGrid();
    }

    function addRandomTile() {
        let empty = [];
        for (let r = 0; r < gridSize; r++) {
            for (let c = 0; c < gridSize; c++) {
                if (grid[r][c] === 0) empty.push({r, c});
            }
        }
        if (empty.length > 0) {
            let {r, c} = empty[Math.floor(Math.random() * empty.length)];
            grid[r][c] = Math.random() < 0.9 ? 2 : 4;
        }
    }

    function renderGrid() {
        const gridEl = document.getElementById('grid');
        gridEl.innerHTML = '';
        for (let r = 0; r < gridSize; r++) {
            for (let c = 0; c < gridSize; c++) {
                const tile = document.createElement('div');
                tile.className = 'tile';
                if (grid[r][c] !== 0) {
                    tile.textContent = grid[r][c];
                    tile.classList.add('new');
                }
                gridEl.appendChild(tile);
            }
        }
    }

    function move(direction) {
        let rotated = false, moved = false;
        for (let i = 0; i < direction; i++) {
            grid = rotateGrid(grid);
            rotated = true;
        }
        for (let r = 0; r < gridSize; r++) {
            let row = grid[r].filter(val => val);
            for (let i = 0; i < row.length - 1; i++) {
                if (row[i] === row[i+1]) {
                    row[i] *= 2;
                    row[i+1] = 0;
                }
            }
            row = row.filter(val => val);
            while (row.length < gridSize) row.push(0);
            if (grid[r].toString() !== row.toString()) moved = true;
            grid[r] = row;
        }
        for (let i = 0; i < (4 - direction) % 4; i++) {
            grid = rotateGrid(grid);
        }
        if (moved) {
            addRandomTile();
            renderGrid();
        }
    }

    function rotateGrid(matrix) {
        return matrix[0].map((_, i) => matrix.map(row => row[i])).reverse();
    }

    document.addEventListener('keydown', e => {
        if (['ArrowUp','w','W'].includes(e.key)) move(0);
        if (['ArrowRight','d','D'].includes(e.key)) move(1);
        if (['ArrowDown','s','S'].includes(e.key)) move(2);
        if (['ArrowLeft','a','A'].includes(e.key)) move(3);
    });

    let touchStartX, touchStartY;
    document.addEventListener('touchstart', e => {
        touchStartX = e.touches[0].clientX;
        touchStartY = e.touches[0].clientY;
    });
    document.addEventListener('touchend', e => {
        let dx = e.changedTouches[0].clientX - touchStartX;
        let dy = e.changedTouches[0].clientY - touchStartY;
        if (Math.abs(dx) > Math.abs(dy)) {
            if (dx > 0) move(1); else move(3);
        } else {
            if (dy > 0) move(2); else move(0);
        }
    });

    initGrid();
</script>
</body>
</html>

<!doctype html>
<!-- 2048 - Red & Black Themed for Denise
     Includes: arrow + WASD + swipe controls, sliding & merging animations,
     moving translucent looping lyrics in background, custom Fraktur font-face
     (path to WOFF2 kept as requested), Times New Roman fallback.
     
     Save as index.html next to a "fonts" folder containing:
     ../fonts/unifrakturmaguntia-v21-latin-regular.woff2
-->
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>2048 — for denise. ily &lt;3 - i.m.</title>

<style>
/* --- Fonts --- */
@font-face {
  font-display: swap;
  font-family: 'UnifrakturMaguntia';
  font-style: normal;
  font-weight: 400;
  src: url('./fonts/unifrakturmaguntia-v21-latin-regular.woff2') format('woff2');
}
:root{
  --bg:#080202;
  --panel:#0f0b0b;
  --accent:#c21a1a; /* red */
  --tile-bg:#1a0f0f;
  --text: #efecec;
  --translucent: rgba(255,255,255,0.08);
  --tile-size: 96px;
  --gap: 16px;
  --board-padding: 18px;
  --board-radius: 12px;
}

/* Reset */
*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0;
  background:linear-gradient(180deg, #000000 0%, #050101 100%);
  color:var(--text);
  font-family: "Times New Roman", Times, serif;
  -webkit-font-smoothing:antialiased;
  -moz-osx-font-smoothing:grayscale;
  overflow:hidden;
}

/* Moving translucent lyrics background */
.lyric-field{
  position:fixed;
  inset:0;
  z-index:0;
  pointer-events:none;
  overflow:hidden;
  background:transparent;
}
.lyric-track{
  position:absolute;
  top:-50%;
  left:-50%;
  width:300%;
  height:300%;
  display:flex;
  flex-wrap:wrap;
  align-content:flex-start;
  transform:translate3d(0,0,0);
  /* animate diagonally down-right */
  animation: drift 60s linear infinite;
  opacity:0.14; /* readable but subtle */
}
.lyric-line{
  white-space:nowrap;
  font-family: 'UnifrakturMaguntia', "Times New Roman", serif;
  font-size:20px;
  letter-spacing:0.6px;
  margin:6px 0;
  padding-right:8px;
  opacity:0.95;
  color:rgba(230,30,30,0.9); /* deep red text, but translucency via container */
  mix-blend-mode:screen;
  user-select:none;
  -webkit-user-select:none;
  transform:translateZ(0);
}

/* diagonal movement bottom-right */
@keyframes drift{
  0%{ transform:translate3d(-10%, -10%, 0); }
  100%{ transform:translate3d(10%, 10%, 0); }
}

/* Main UI container */
.app{
  position:relative;
  z-index:2;
  width:100%;
  height:100%;
  display:flex;
  align-items:center;
  justify-content:center;
  padding:24px;
}

/* Game board card */
.container{
  width: calc(var(--tile-size) * 4 + var(--gap) * 3 + var(--board-padding) * 2);
  max-width:92vw;
  background:linear-gradient(180deg, rgba(18,6,6,0.85), rgba(6,2,2,0.95));
  border-radius:16px;
  box-shadow: 0 10px 40px rgba(0,0,0,0.7), 0 0 0 1px rgba(255,0,0,0.03) inset;
  padding:22px;
  position:relative;
}

/* small dedication text overlay top-left */
.dev-note{
  position:absolute;
  left:20px;
  top:18px;
  z-index:5;
  font-family: 'UnifrakturMaguntia', "Times New Roman", serif;
  color:var(--accent);
  font-size:14px;
  letter-spacing:0.6px;
  user-select:none;
  pointer-events:none;
  mix-blend-mode:normal;
}

/* header with title and score */
.header{
  display:flex;
  justify-content:space-between;
  align-items:center;
  margin-bottom:16px;
}
.title{
  font-size:26px;
  color:var(--text);
  font-weight:700;
  letter-spacing:1px;
  margin:0;
  font-family: "Times New Roman", Times, serif;
  text-shadow: 0 2px 0 rgba(0,0,0,0.7);
}
.controls{
  display:flex;
  gap:10px;
  align-items:center;
}
.status{
  background:linear-gradient(180deg, rgba(255,20,20,0.06), rgba(160,0,0,0.06));
  padding:8px 12px;
  border-radius:8px;
  display:flex;
  gap:8px;
  align-items:center;
  font-weight:700;
  color:var(--text);
  font-size:14px;
}

/* board area */
.board-wrap{
  background: linear-gradient(180deg, rgba(20,7,7,0.35), rgba(10,3,3,0.35));
  padding: var(--board-padding);
  border-radius: var(--board-radius);
  position:relative;
  overflow:visible;
}

/* grid background (static) */
.grid{
  width: calc(var(--tile-size) * 4 + var(--gap) * 3);
  height: calc(var(--tile-size) * 4 + var(--gap) * 3);
  display:grid;
  grid-template-columns: repeat(4, var(--tile-size));
  grid-template-rows: repeat(4, var(--tile-size));
  gap: var(--gap);
  position:relative;
  background:transparent;
}

/* empty cells */
.cell{
  background: rgba(255,255,255,0.03);
  border-radius:8px;
  box-shadow: inset 0 -2px 0 rgba(0,0,0,0.6);
}

/* tile layer sits above cells */
.tile-layer{
  position:absolute;
  inset:0;
  pointer-events:none;
}

/* each tile */
.tile{
  position:absolute;
  width:var(--tile-size);
  height:var(--tile-size);
  display:flex;
  align-items:center;
  justify-content:center;
  border-radius:8px;
  font-weight:700;
  font-size:26px;
  font-family: "Times New Roman", Times, serif;
  color:var(--text);
  transform: translate3d(0,0,0);
  transition: transform 180ms cubic-bezier(.22,.9,.3,1), width 100ms linear, height 100ms linear;
  box-shadow: 0 6px 18px rgba(0,0,0,0.6);
  backface-visibility:hidden;
  will-change: transform;
  text-shadow: 0 1px 0 rgba(0,0,0,0.6);
}

/* tile backgrounds by value (a few examples) */
.tile.val-2  { background: linear-gradient(180deg,#1c0b0b,#120606); color:#e9d7d7; }
.tile.val-4  { background: linear-gradient(180deg,#261010,#170505); color:#f1d7d7; }
.tile.val-8  { background: linear-gradient(180deg,#3a0f0f,#240606); color:#fff0f0; }
.tile.val-16 { background: linear-gradient(180deg,#521313,#2a0606); color:#fff3f3; font-size:22px; }
.tile.val-32 { background: linear-gradient(180deg,#6b1616,#310707); font-size:20px; }
.tile.val-64 { background: linear-gradient(180deg,#8e1b1b,#430808); font-size:20px; font-weight:800;}
.tile.val-128{ background: linear-gradient(180deg,#b21f1f,#5b0a0a); font-size:18px; }
.tile.val-256{ background: linear-gradient(180deg,#d22727,#6e0b0b); font-size:18px;}
.tile.val-512{ background: linear-gradient(180deg,#ec2b2b,#8a0d0d); font-size:16px;}
.tile.val-1024{ background: linear-gradient(180deg,#ff3333,#a00f0f); font-size:14px;}
.tile.val-2048{ background: linear-gradient(180deg,#ff5555,#c21a1a); font-size:14px; font-weight:900; }

/* spawn (pop) animation */
.tile.spawn{
  animation: pop 160ms ease;
}
@keyframes pop{
  0%{ transform: scale(0.2) translate3d(0,0,0); opacity:0; }
  60%{ transform: scale(1.08) translate3d(0,0,0); opacity:1; }
  100%{ transform: scale(1) translate3d(0,0,0); }
}
/* merge pulse */
.tile.merge-pulse{
  animation: mergePulse 200ms ease;
}
@keyframes mergePulse{
  0%{ transform: scale(1.15); }
  100%{ transform: scale(1); }
}

/* small help text removed by request — we won't include guides */

/* bottom overlay for lost/won */
.overlay{
  position:absolute;
  inset:0;
  display:flex;
  align-items:center;
  justify-content:center;
  border-radius:inherit;
  background: linear-gradient(180deg, rgba(0,0,0,0.55), rgba(0,0,0,0.6));
  z-index:10;
  color:var(--text);
  font-size:28px;
  text-align:center;
  padding:18px;
  display:none;
}
.overlay.show{ display:flex; }

/* footer-ish small controls — but minimal */
.footer{
  display:flex;
  justify-content:space-between;
  align-items:center;
  margin-top:12px;
  gap:12px;
  color:rgba(255,255,255,0.7);
  font-size:13px;
}
.btn{
  background:transparent;
  border:1px solid rgba(255,255,255,0.06);
  color:var(--text);
  padding:8px 10px;
  border-radius:8px;
  cursor:pointer;
  font-weight:700;
}
.btn:active{ transform:translateY(1px) }

/* subtle red glow around container */
.container::after{
  content:"";
  position:absolute;
  inset:0;
  border-radius:inherit;
  box-shadow: 0 0 80px rgba(194,26,26,0.06) inset;
  pointer-events:none;
}

/* responsive */
@media (max-width:420px){
  :root{ --tile-size:72px; --gap:12px; --board-padding:12px; }
  .title{ font-size:20px; }
  .lyric-line{ font-size:14px; }
}
</style>
</head>
<body>
  <div class="lyric-field" aria-hidden="true">
    <div class="lyric-track" id="lyricTrack">
      <!-- We'll populate many repeated lyric lines via JS to ensure no gaps -->
    </div>
  </div>

  <main class="app" role="application" aria-label="2048 game for denise">
    <div class="container" id="gameContainer">
      <div class="dev-note">for denise. ily &lt;3 — i.m.</div>

      <div class="header">
        <h1 class="title">2048</h1>
        <div class="controls" aria-hidden="true">
          <div class="status" id="scoreBox">Score: <span id="score">0</span></div>
          <button class="btn" id="newGameBtn" title="New Game">New</button>
          <button class="btn" id="undoBtn" title="Undo (1 step)" disabled>Undo</button>
        </div>
      </div>

      <div class="board-wrap" id="boardWrap">
        <div class="grid" id="grid">
          <!-- 16 static cells -->
        </div>
        <div class="tile-layer" id="tileLayer"></div>

        <div class="overlay" id="overlay"></div>
      </div>

      <div class="footer" style="opacity:0.9;">
        <div>Use ←↑→↓ or WASD. Swipe on touch.</div>
        <div style="opacity:0.9">Theme: red & black</div>
      </div>
    </div>
  </main>

<script>
/* 2048 core logic with animations and swipe support
   - 4x4 grid
   - keyboard arrows + WASD
   - touch swipe (basic)
   - sliding + merge animations using CSS transforms
   - undo support (1 step)
*/

(() => {
  const SIZE = 4;
  const tileSize = parseInt(getComputedStyle(document.documentElement).getPropertyValue('--tile-size')) || 96;
  const gap = parseInt(getComputedStyle(document.documentElement).getPropertyValue('--gap')) || 16;
  const gridEl = document.getElementById('grid');
  const tileLayer = document.getElementById('tileLayer');
  const scoreEl = document.getElementById('score');
  const overlay = document.getElementById('overlay');
  const newBtn = document.getElementById('newGameBtn');
  const undoBtn = document.getElementById('undoBtn');

  // lyrics text (user provided) — we will render many repeated lines
  const lyrics = `I never said I'd lie in wait forever... If I died, we'd be together, now. I can't always just forget her. But she could try... At the end of the world, or the last thing I see you are never coming home, never coming home--
